function dTree(a,b){this.config={target:null,folderLinks:true,useSelection:true,useCookies:true,useLines:true,useIcons:true,useStatusText:false,closeSameLevel:false,inOrder:false};if(b){this.icon=b}else{this.icon={root:"img/base.gif",folder:"img/folder.gif",folderOpen:"img/folderopen.gif",node:"img/page.gif",empty:"img/empty.gif",line:"img/line.gif",join:"img/join.gif",joinBottom:"img/joinbottom.gif",plus:"img/plus.gif",plusBottom:"img/plusbottom.gif",minus:"img/minus.gif",minusBottom:"img/minusbottom.gif",nlPlus:"img/nolines_plus.gif",nlMinus:"img/nolines_minus.gif"}}this.obj=a;this.aNodes=[];this.aIndent=[];this.root=new Node(-1);this.selectedNode=null;this.selectedFound=false;this.completed=false}function Node(a,b,c,d,e,f,g,h,i){this.id=a;this.pid=b;this.name=c;this.url=d;this.title=e;this.target=f;this.icon=g;this.iconOpen=h;this._io=i||false;this._is=false;this._ls=false;this._hc=false;this._ai=0;this._p}dTree.prototype.add=function(a,b,c,d,e,f,g,h,i){this.aNodes[this.aNodes.length]=new Node(a,b,c,d,e,f,g,h,i)};dTree.prototype.openAll=function(){this.oAll(true)};dTree.prototype.closeAll=function(){this.oAll(false)};dTree.prototype.toString=function(){var a='<div class="dtree">\n';if(document.getElementById){if(this.config.useCookies)this.selectedNode=this.getSelected();a+=this.addNode(this.root)}else a+="Browser not supported.";a+="</div>";if(!this.selectedFound)this.selectedNode=null;this.completed=true;return a};dTree.prototype.addNode=function(a){var b="";var c=0;if(this.config.inOrder)c=a._ai;for(c;c<this.aNodes.length;c++){if(this.aNodes[c].pid==a.id){var d=this.aNodes[c];d._p=a;d._ai=c;this.setCS(d);if(!d.target&&this.config.target)d.target=this.config.target;if(d._hc&&!d._io&&this.config.useCookies)d._io=this.isOpen(d.id);if(!this.config.folderLinks&&d._hc)d.url=null;if(this.config.useSelection&&d.id==this.selectedNode&&!this.selectedFound){d._is=true;this.selectedNode=c;this.selectedFound=true}b+=this.node(d,c);if(d._ls)break}}return b};dTree.prototype.node=function(a,b){var c='<div class="dTreeNode">'+this.indent(a,b);if(this.config.useIcons){if(!a.icon)a.icon=this.root.id==a.pid?this.icon.root:a._hc?this.icon.folder:this.icon.node;if(!a.iconOpen)a.iconOpen=a._hc?this.icon.folderOpen:this.icon.node;if(this.root.id==a.pid){a.icon=this.icon.root;a.iconOpen=this.icon.root}c+='<img id="i'+this.obj+b+'" src="'+(a._io?a.iconOpen:a.icon)+'" alt="" />'}if(a.url){c+='<a id="s'+this.obj+b+'" class="'+(this.config.useSelection?a._is?"nodeSel":"node":"node")+'" href="'+a.url+'"';if(a.title)c+=' title="'+a.title+'"';if(a.target)c+=' target="'+a.target+'"';if(this.config.useStatusText)c+=" onmouseover=\"window.status='"+a.name+"';return true;\" onmouseout=\"window.status='';return true;\" ";if(this.config.useSelection&&(a._hc&&this.config.folderLinks||!a._hc))c+=' onclick="javascript: '+this.obj+".s("+b+');"';c+=">"}else if((!this.config.folderLinks||!a.url)&&a._hc&&a.pid!=this.root.id)c+='<a href="javascript: '+this.obj+".o("+b+');" class="node">';c+=a.name;if(a.url||(!this.config.folderLinks||!a.url)&&a._hc)c+="</a>";c+="</div>";if(a._hc){c+='<div id="d'+this.obj+b+'" class="clip" style="display:'+(this.root.id==a.pid||a._io?"block":"none")+';">';c+=this.addNode(a);c+="</div>"}this.aIndent.pop();return c};dTree.prototype.indent=function(a,b){var c="";if(this.root.id!=a.pid){for(var d=0;d<this.aIndent.length;d++)c+='<img src="'+(this.aIndent[d]==1&&this.config.useLines?this.icon.line:this.icon.empty)+'" alt="" />';a._ls?this.aIndent.push(0):this.aIndent.push(1);if(a._hc){c+='<a href="javascript: '+this.obj+".o("+b+');"><img id="j'+this.obj+b+'" src="';if(!this.config.useLines)c+=a._io?this.icon.nlMinus:this.icon.nlPlus;else c+=a._io?a._ls&&this.config.useLines?this.icon.minusBottom:this.icon.minus:a._ls&&this.config.useLines?this.icon.plusBottom:this.icon.plus;c+='" alt="" /></a>'}else c+='<img src="'+(this.config.useLines?a._ls?this.icon.joinBottom:this.icon.join:this.icon.empty)+'" alt="" />'}return c};dTree.prototype.setCS=function(a){var b;for(var c=0;c<this.aNodes.length;c++){if(this.aNodes[c].pid==a.id)a._hc=true;if(this.aNodes[c].pid==a.pid)b=this.aNodes[c].id}if(b==a.id)a._ls=true};dTree.prototype.getSelected=function(){var a=this.getCookie("cs"+this.obj);return a?a:null};dTree.prototype.s=function(a){if(!this.config.useSelection)return;var b=this.aNodes[a];if(b._hc&&!this.config.folderLinks)return;if(this.selectedNode!=a){if(this.selectedNode||this.selectedNode==0){eOld=document.getElementById("s"+this.obj+this.selectedNode);eOld.className="node"}eNew=document.getElementById("s"+this.obj+a);eNew.className="nodeSel";this.selectedNode=a;if(this.config.useCookies)this.setCookie("cs"+this.obj,b.id)}};dTree.prototype.o=function(a){var b=this.aNodes[a];this.nodeStatus(!b._io,a,b._ls);b._io=!b._io;if(this.config.closeSameLevel)this.closeLevel(b);if(this.config.useCookies)this.updateCookie()};dTree.prototype.oAll=function(a){for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b]._hc&&this.aNodes[b].pid!=this.root.id){this.nodeStatus(a,b,this.aNodes[b]._ls);this.aNodes[b]._io=a}}if(this.config.useCookies)this.updateCookie()};dTree.prototype.openTo=function(a,b,c){if(!c){for(var d=0;d<this.aNodes.length;d++){if(this.aNodes[d].id==a){a=d;break}}}var e=this.aNodes[a];if(e.pid==this.root.id||!e._p)return;e._io=true;e._is=b;if(this.completed&&e._hc)this.nodeStatus(true,e._ai,e._ls);if(this.completed&&b)this.s(e._ai);else if(b)this._sn=e._ai;this.openTo(e._p._ai,false,true)};dTree.prototype.closeLevel=function(a){for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b].pid==a.pid&&this.aNodes[b].id!=a.id&&this.aNodes[b]._hc){this.nodeStatus(false,b,this.aNodes[b]._ls);this.aNodes[b]._io=false;this.closeAllChildren(this.aNodes[b])}}};dTree.prototype.closeAllChildren=function(a){for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b].pid==a.id&&this.aNodes[b]._hc){if(this.aNodes[b]._io)this.nodeStatus(false,b,this.aNodes[b]._ls);this.aNodes[b]._io=false;this.closeAllChildren(this.aNodes[b])}}};dTree.prototype.nodeStatus=function(a,b,c){eDiv=document.getElementById("d"+this.obj+b);eJoin=document.getElementById("j"+this.obj+b);if(this.config.useIcons){eIcon=document.getElementById("i"+this.obj+b);eIcon.src=a?this.aNodes[b].iconOpen:this.aNodes[b].icon}eJoin.src=this.config.useLines?a?c?this.icon.minusBottom:this.icon.minus:c?this.icon.plusBottom:this.icon.plus:a?this.icon.nlMinus:this.icon.nlPlus;eDiv.style.display=a?"block":"none"};dTree.prototype.clearCookie=function(){var a=new Date;var b=new Date(a.getTime()-1e3*60*60*24);this.setCookie("co"+this.obj,"cookieValue",b);this.setCookie("cs"+this.obj,"cookieValue",b)};dTree.prototype.setCookie=function(a,b,c,d,e,f){document.cookie=escape(a)+"="+escape(b)+(c?"; expires="+c.toGMTString():"")+(d?"; path="+d:"")+(e?"; domain="+e:"")+(f?"; secure":"")};dTree.prototype.getCookie=function(a){var b="";var c=document.cookie.indexOf(escape(a)+"=");if(c!=-1){var d=c+(escape(a)+"=").length;var e=document.cookie.indexOf(";",d);if(e!=-1)b=unescape(document.cookie.substring(d,e));else b=unescape(document.cookie.substring(d))}return b};dTree.prototype.updateCookie=function(){var a="";for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b]._io&&this.aNodes[b].pid!=this.root.id){if(a)a+=".";a+=this.aNodes[b].id}}this.setCookie("co"+this.obj,a)};dTree.prototype.isOpen=function(a){var b=this.getCookie("co"+this.obj).split(".");for(var c=0;c<b.length;c++)if(b[c]==a)return true;return false};if(!Array.prototype.push){Array.prototype.push=function a(){for(var a=0;a<arguments.length;a++)this[this.length]=arguments[a];return this.length}}if(!Array.prototype.pop){Array.prototype.pop=function b(){lastElement=this[this.length-1];this.length=Math.max(this.length-1,0);return lastElement}}